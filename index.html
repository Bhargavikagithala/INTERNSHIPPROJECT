<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smart Cab Booking</title>
  <meta name="description" content="Responsive AI-powered cab booking demo with Google Maps integration." />
  <style>
    :root{--accent:#0b76ef;--muted:#6b7280;--card:#ffffff;--bg:#f3f5f9}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:#111}
    .container{max-width:1100px;margin:auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .logo{background:linear-gradient(135deg,var(--accent),#4fb2ff);color:#fff;font-weight:700;padding:12px 16px;border-radius:10px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 4px 12px rgba(0,0,0,0.06)}
    .btn{padding:10px 14px;border:none;border-radius:8px;background:var(--accent);color:white;font-weight:600;cursor:pointer}
    input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #e4e7ec;font-size:14px}
    label{font-size:12px;color:var(--muted)}
    .app{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:20px}
    @media(max-width:920px){.app{grid-template-columns:1fr}}
    #map{width:100%;height:320px;border-radius:10px;margin-top:10px}
    .chatbot{position:fixed;bottom:20px;right:20px;width:280px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.2);display:flex;flex-direction:column;overflow:hidden;font-size:14px}
    .chat-header{background:var(--accent);color:#fff;padding:10px;font-weight:600;text-align:center}
    .chat-body{padding:10px;height:200px;overflow-y:auto}
    .chat-input{display:flex;border-top:1px solid #eee}
    .chat-input input{flex:1;border:none;padding:10px}
    .chat-input button{background:var(--accent);color:white;border:none;padding:10px 14px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">ðŸš– CabBook AI</div>
      <div class="muted">Smart booking â€¢ Live map â€¢ AI helper</div>
    </header>

    <main class="app">
      <section>
        <div class="card">
          <h3>Book your ride</h3>
          <form id="form">
            <label>Pickup Location</label>
            <input id="pickup" placeholder="Enter pickup" required />
            <label>Drop Location</label>
            <input id="drop" placeholder="Enter drop" required />
            <label>Date & Time</label>
            <input id="datetime" type="datetime-local" />
            <label>Vehicle Type</label>
            <select id="vehicle">
              <option value="mini">Mini</option>
              <option value="sedan">Sedan</option>
              <option value="suv">SUV</option>
              <option value="lux">Luxury</option>
            </select>
            <button class="btn" type="submit">Find Ride</button>
          </form>
          <div id="map"></div>
          <div id="fare" style="margin-top:10px;font-weight:600"></div>
        </div>
      </section>

      <aside>
        <div class="card">
          <h3>Ride Summary</h3>
          <p id="summary">Fill details and search to get started.</p>
        </div>
      </aside>
    </main>
  </div>

  <!-- Chatbot -->
  <div class="chatbot" id="chat">
    <div class="chat-header">Ride Assistant ðŸ¤–</div>
    <div class="chat-body" id="chatBody"></div>
    <div class="chat-input">
      <input id="chatMsg" placeholder="Ask about fare or routes..." />
      <button onclick="sendMsg()">â–¶</button>
    </div>
  </div>

  <script>
    let map, directionsService, directionsRenderer;
    let pickupPlace, dropPlace;

    function initMap() {
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 17.3850, lng: 78.4867 }, zoom: 12,
      });
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({ map });

      const pickupInput = document.getElementById("pickup");
      const dropInput = document.getElementById("drop");

      const autocompletePickup = new google.maps.places.Autocomplete(pickupInput);
      const autocompleteDrop = new google.maps.places.Autocomplete(dropInput);

      autocompletePickup.addListener("place_changed", () => {
        pickupPlace = autocompletePickup.getPlace();
      });
      autocompleteDrop.addListener("place_changed", () => {
        dropPlace = autocompleteDrop.getPlace();
      });
    }

    document.getElementById("form").addEventListener("submit", (e) => {
      e.preventDefault();
      if (!pickupPlace || !dropPlace) {
        alert("Please select valid locations from suggestions.");
        return;
      }
      calculateRoute();
    });

    function calculateRoute() {
      const req = {
        origin: pickupPlace.geometry.location,
        destination: dropPlace.geometry.location,
        travelMode: "DRIVING"
      };
      directionsService.route(req, (res, status) => {
        if (status === "OK") {
          directionsRenderer.setDirections(res);
          const dist = res.routes[0].legs[0].distance.value / 1000;
          const time = res.routes[0].legs[0].duration.text;
          const type = document.getElementById("vehicle").value;
          const fare = calcFare(type, dist);
          document.getElementById("fare").textContent = 
            `Distance: ${dist.toFixed(1)} km â€¢ Est time: ${time} â€¢ Fare: â‚¹${fare}`;
          document.getElementById("summary").innerHTML = 
            `<b>${type.toUpperCase()}</b> from <i>${pickupPlace.name}</i> to <i>${dropPlace.name}</i><br>
             Distance: ${dist.toFixed(1)} km â€¢ Fare: â‚¹${fare}`;
        } else alert("Route not found.");
      });
    }

    function calcFare(type, dist) {
      const rates = { mini: 10, sedan: 14, suv: 18, lux: 30 };
      const base = { mini: 50, sedan: 70, suv: 90, lux: 150 };
      return (base[type] + dist * rates[type]).toFixed(0);
    }

    // AI Chat Assistant
    const chatBody = document.getElementById("chatBody");
    function sendMsg() {
      const msg = document.getElementById("chatMsg").value.trim();
      if (!msg) return;
      appendMsg("user", msg);
      document.getElementById("chatMsg").value = "";
      setTimeout(() => {
        appendMsg("bot", getBotReply(msg));
      }, 500);
    }

    function appendMsg(sender, text) {
      const el = document.createElement("div");
      el.style.margin = "6px 0";
      el.style.textAlign = sender === "bot" ? "left" : "right";
      el.innerHTML = sender === "bot"
        ? `<div style="background:#eef6ff;display:inline-block;padding:6px 10px;border-radius:8px">${text}</div>`
        : `<div style="background:#0b76ef;color:white;display:inline-block;padding:6px 10px;border-radius:8px">${text}</div>`;
      chatBody.appendChild(el);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function getBotReply(msg) {
      msg = msg.toLowerCase();
      if (msg.includes("fare")) return "Fares depend on distance and cab type. Try entering locations for an estimate!";
      if (msg.includes("available")) return "We have Mini, Sedan, SUV, and Luxury rides available 24/7.";
      if (msg.includes("hello")) return "Hello! How can I help you plan your ride today?";
      if (msg.includes("book")) return "You can fill the form and click 'Find Ride' to confirm your booking.";
      return "I'm your ride assistant! Ask me about fares, cabs, or routes.";
    }
  </script>

  <!-- Google Maps Script -->
  <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBChtpfxdTTuHGV_UY1-i6EpBhC03-1K1M&libraries=places&callback=initMap">
  </script>
</body>
</html>
